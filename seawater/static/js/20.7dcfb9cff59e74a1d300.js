webpackJsonp([20],{1052:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"my-group-list-container"},[n("el-card",{staticClass:"card-container"},[n("div",{staticClass:"clear-fix card-header",attrs:{slot:"header"},slot:"header"},[n("div",{staticStyle:{"line-height":"36px"}},[n("el-icon",{staticClass:"el-icon-coral-list"}),t._v(" "),n("span",{staticClass:"my-cart-name"},[t._v("我开的团单")])],1)]),t._v(" "),n("el-col",{attrs:{xs:24,sm:24,md:24,lg:24}},[n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-striped"},[n("thead",[n("tr",[n("th",[t._v("团单名")]),t._v(" "),n("th",[t._v("团单状态")]),t._v(" "),n("th",[t._v("我的金额")]),t._v(" "),n("th",[t._v("所得积分")]),t._v(" "),n("th",[t._v("截止时间")]),t._v(" "),n("th",{staticClass:"action-th"},[t._v("操作")])])]),t._v(" "),n("tbody",t._l(t.groupList,function(e){return n("tr",{key:e.id},[n("td",[n("a",{attrs:{href:"javascript: void (0);"},on:{click:function(n){t.handleActions(e,"groupDetail")}}},[t._v("\n                                "+t._s(e.name)+"\n                            ")])]),t._v(" "),n("td",[1===e.status?n("el-tag",{attrs:{type:"success"}},[t._v("热团中")]):n("el-tag",[t._v("已结束")])],1),t._v(" "),n("td",[n("span",{staticStyle:{color:"#d0021b"}},[t._v(t._s("￥"+e.sum.toFixed(2)))])]),t._v(" "),n("td",[t._v("0")]),t._v(" "),n("td",[t._v(t._s(e.end_date))]),t._v(" "),n("td",{attrs:{align:"center"}},[n("el-button",{attrs:{title:"编辑",size:"small",icon:"edit"},on:{click:function(n){t.handleActions(e,"groupEdit")}}}),t._v(" "),1===e.status?n("el-button",{attrs:{title:"结束",size:"small",icon:"coral-close"},on:{click:function(n){t.handleActions(e,"delete")}}}):t._e(),t._v(" "),0===e.status?n("el-button",{attrs:{title:"重新开始",size:"small",icon:"coral-check"},on:{click:function(n){t.handleActions(e,"reopen")}}}):t._e(),t._v(" "),n("el-button",{attrs:{title:"导出",size:"small",icon:"coral-down"},on:{click:function(n){t.downloadAboutGroup(e)}}}),t._v(" "),"tggly"===t.currentUser.type||"lss"===t.currentUser.type||"pfs"===t.currentUser.type?n("el-button",{attrs:{disabled:1!=e.private,title:"私密单",size:"small",icon:"coral-attentionforbid"},on:{click:function(n){t.getQrCodeInGroup(e)}}}):t._e(),t._v(" "),n("el-button",{attrs:{title:"订单",size:"small",icon:"coral-list"},on:{click:function(n){t.handleActions(e,"cartGroup")}}})],1)])}))])])]),t._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[10,20,30,40],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"提示",size:"tiny",visible:t.dialogVisible,"before-close":t.handleCancel},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("span",[t._v("你确定结束团单"+t._s(t.currentRow.name)+"？")]),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.handleConfirm}},[t._v("确定")]),t._v(" "),n("el-button",{on:{click:t.handleCancel}},[t._v("取消")])],1)]),t._v(" "),n("el-dialog",{attrs:{title:"重新开始",size:"tiny",visible:t.reopenVisible,"before-close":t.handleReopenCancel},on:{"update:visible":function(e){t.reopenVisible=e}}},[n("el-form",{attrs:{"label-width":"70px"}},[n("el-form-item",{attrs:{label:"截止时间"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择截止时间",editable:!1,"picker-options":t.pickerOptions},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.handleConfirmReopen}},[t._v("确定")]),t._v(" "),n("el-button",{on:{click:t.handleReopenCancel}},[t._v("取消")])],1)],1),t._v(" "),n("el-dialog",{staticClass:"private-dialog",attrs:{title:"私密单入口",size:"tiny",visible:t.qrCodeVisible,"before-close":t.handleQrCodeCancel},on:{"update:visible":function(e){t.qrCodeVisible=e}}},[n("img",{attrs:{src:t.qrCodeUrl}}),t._v(" "),n("span",[t._v("私密单路径："+t._s(t.privateUrl))])])],1)},staticRenderFns:[]}},584:function(t,e,n){n(981);var r=n(223)(n(823),n(1052),null,null);t.exports=r.exports},600:function(t,e,n){t.exports={default:n(605),__esModule:!0}},601:function(t,e,n){"use strict";n.d(e,"f",function(){return l}),n.d(e,"e",function(){return p}),n.d(e,"a",function(){return g}),n.d(e,"c",function(){return f}),n.d(e,"b",function(){return v}),n.d(e,"d",function(){return h}),n.d(e,"k",function(){return m}),n.d(e,"h",function(){return b}),n.d(e,"g",function(){return y}),n.d(e,"i",function(){return _});var r=n(603),a=n.n(r),i=n(600),o=n.n(i),s=n(225),c=n.n(s),l=function(t){var e=new FormData,n=!0,r=!1,a=void 0;try{for(var i,s=c()(o()(t));!(n=(i=s.next()).done);n=!0){var l=i.value;e.append(l,t[l])}}catch(t){r=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return e},u=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,r="",a=0;a<t;a++)r+=e.charAt(Math.floor(Math.random()*n));return r},d=function(t){var e=new Date(t),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate();return""+e.getFullYear()+n+r+"235959"},p=function(t){return!t&&0!==t||("string"==typeof t&&!t.trim()||(!(!Array.prototype.isPrototypeOf(t)||0!==t.length)||!(!Object.prototype.isPrototypeOf(t)||0!==o()(t).length)))},g=function(t){return!p(window.localStorage.getItem(t))},f=function(t,e){p(e)||window.localStorage.setItem(t,a()(e))},v=function(t){return JSON.parse(window.localStorage.getItem(t))},h=function(t,e){var n=!0,r=!1,a=void 0;try{for(var i,o=c()(e);!(n=(i=o.next()).done);n=!0){var s=i.value;if(s.code===t)return s.name}}catch(t){r=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return""},m=function(t,e){var n=!0,r=!1,a=void 0;try{for(var i,o=c()(e);!(n=(i=o.next()).done);n=!0){var s=i.value;if(s.key===t)return s.value}}catch(t){r=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return""},b=function(t){var e=void 0;e="string"==typeof t?new Date(t):t;var n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate();return""+e.getFullYear()+n+r+"235959"},y=function(t){var e=void 0;e="string"==typeof t?new Date(t):t;var n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate(),a=e.getHours()<10?"0"+e.getHours():e.getHours(),i=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),o=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return""+e.getFullYear()+n+r+a+i+o},_=function(t){var e=document.getElementById(t),n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,1,12,345,7,220,!1,!1,!0,!1,0,null),e.dispatchEvent(n)};e.j={randomString:u,formatDate:d}},603:function(t,e,n){t.exports={default:n(604),__esModule:!0}},604:function(t,e,n){var r=n(20),a=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return a.stringify.apply(a,arguments)}},605:function(t,e,n){n(607),t.exports=n(20).Object.keys},606:function(t,e,n){var r=n(37),a=n(20),i=n(67);t.exports=function(t,e){var n=(a.Object||{})[t]||Object[t],o={};o[t]=e(n),r(r.S+r.F*i(function(){n(1)}),"Object",o)}},607:function(t,e,n){var r=n(148),a=n(74);n(606)("keys",function(){return function(t){return a(r(t))}})},823:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(58),a=n.n(r),i=n(57),o=n.n(i),s=n(99),c=n.n(s),l=n(224),u=n(59),d=n(601);e.default={data:function(){return{groupList:[],currentRow:{},totalCount:0,page:1,size:10,dialogVisible:!1,reopenVisible:!1,qrCodeVisible:!1,pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},endDate:"",qrCodeUrl:"",privateUrl:""}},computed:c()({},n.i(l.b)(["currentUser"])),created:function(){this.currentUser&&this.currentUser.id&&this.initData()},methods:c()({},n.i(l.c)(["loading","getGroupList","finishGroupByIdAndUserId","downloadGroupByIdAndUserId","reopenGroupByIdAndUserId","getQrCodeByGroupId"]),{initData:function(){var t=this;return o()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading(!0),n=[],e.prev=2,e.next=5,t.getGroupList({page:t.page,size:t.size,userId:t.currentUser.id});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:t.loading(!1),t.groupList=n.res||[],t.totalCount=n.count_res?n.count_res[0].count:1;case 14:case"end":return e.stop()}},e,t,[[2,8]])}))()},handleSizeChange:function(t){this.size=t,this.initData()},handleCurrentChange:function(t){this.page=t,this.initData()},handleActions:function(t,e){switch(e){case"groupEdit":case"groupDetail":this.$router.push({name:e,params:{id:t.id}});break;case"cartGroup":this.$router.push({name:e,params:{groupId:t.id,userId:t.user_id},query:{groupName:t.name}});break;case"delete":this.currentRow=t,this.dialogVisible=!0;break;case"reopen":this.currentRow=t,this.reopenVisible=!0}},downloadAboutGroup:function(t){var e=this;return o()(a.a.mark(function n(){var r,i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.loading(!0),r={},n.prev=2,n.next=5,e.downloadGroupByIdAndUserId({id:t.id,user_id:t.user_id});case 5:r=n.sent,"ok"===r.status&&(i=document.createElement("iframe"),i.src=""+u.k+r.name+"?"+Math.random(),i.style.display="none",document.body.appendChild(i)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),console.error(n.t0);case 12:e.loading(!1);case 13:case"end":return n.stop()}},n,e,[[2,9]])}))()},getQrCodeInGroup:function(t){var e=this;return o()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.loading(!0),r={},n.prev=2,n.next=5,e.getQrCodeByGroupId({id:t.id,user_id:t.user_id});case 5:r=n.sent,"ok"===r.status&&(e.qrCodeVisible=!0,e.qrCodeUrl="http://www.coral123.com/image/user/private/"+t.id+".png",e.privateUrl="http://www.coral123.com/#/buy/"+t.id+"/page"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),console.error(n.t0);case 12:e.loading(!1);case 13:case"end":return n.stop()}},n,e,[[2,9]])}))()},handleCancel:function(){this.currentRow={},this.dialogVisible=!1},handleReopenCancel:function(){this.currentRow={},this.reopenVisible=!1},handleQrCodeCancel:function(){this.qrCodeVisible=!1},handleConfirm:function(){var t=this;return o()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.dialogVisible=!1,n={},t.loading(!0),e.prev=3,e.next=6,t.finishGroupByIdAndUserId({id:t.currentRow.id,user_id:t.currentUser.id});case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error(e.t0);case 12:t.loading(!1),"ok"===n.status&&(t.$message({type:"success",message:"结束团单"+t.currentRow.name+"成功"}),t.initData());case 14:case"end":return e.stop()}},e,t,[[3,9]])}))()},handleConfirmReopen:function(){var t=this;return o()(a.a.mark(function e(){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.endDate){e.next=3;break}return t.$notify({type:"warning",message:"请选择截止时间"}),e.abrupt("return");case 3:return t.reopenVisible=!1,t.loading(!0),r={},e.prev=6,e.next=9,t.reopenGroupByIdAndUserId({id:t.currentRow.id,user_id:t.currentUser.id,end_date:n.i(d.g)(t.endDate)});case 9:r=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),console.error(e.t0);case 15:t.loading(!1),"ok"===r.status&&(t.$message({type:"success",message:"重新开始团购"+t.currentRow.name+"成功",duration:5e3}),t.endDate="",t.initData());case 17:case"end":return e.stop()}},e,t,[[6,12]])}))()}}),watch:{$route:function(t){"myGroups"===t.name&&this.initData()},currentUser:{handler:function(){this.initData()},deep:!0}}}},876:function(t,e,n){e=t.exports=n(556)(!1),e.push([t.i,".my-group-list-container{padding:10px}.my-group-list-container .el-date-editor{width:100%}.my-group-list-container .private-dialog img{width:300px;height:300px}.my-group-list-container .private-dialog .el-dialog__body{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.my-group-list-container .card-container .el-card__header{padding:10px 20px}.my-group-list-container .card-container .el-card__body{padding:10px}.my-group-list-container .card-container .el-button{background:transparent;border:none}.my-group-list-container .card-container .el-button i,.my-group-list-container .card-container .el-button span{color:#20a0ff}.my-group-list-container .card-container .el-button:focus,.my-group-list-container .card-container .el-button:hover{background:#20a0ff}.my-group-list-container .card-container .el-button:focus i,.my-group-list-container .card-container .el-button:focus span,.my-group-list-container .card-container .el-button:hover i,.my-group-list-container .card-container .el-button:hover span{color:#fff}.my-group-list-container .card-container .el-button.is-disabled{background:transparent}.my-group-list-container .card-container .el-button.is-disabled i,.my-group-list-container .card-container .el-button.is-disabled span{color:#bfcbd9}.my-group-list-container .card-container .el-button.is-disabled:focus,.my-group-list-container .card-container .el-button.is-disabled:hover{background:transparent}.my-group-list-container .card-container .el-button.is-disabled:focus i,.my-group-list-container .card-container .el-button.is-disabled:focus span,.my-group-list-container .card-container .el-button.is-disabled:hover i,.my-group-list-container .card-container .el-button.is-disabled:hover span{color:#bfcbd9}.my-group-list-container .card-container .table td{vertical-align:middle;padding:4px}.my-group-list-container .card-container .table .action-th{text-align:center}.my-group-list-container .card-container .card-header{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.my-group-list-container .card-container .card-header .el-icon-coral-cart{font-size:16px}.my-group-list-container .card-container .my-cart-name{font-size:16px;font-weight:700}.my-group-list-container .card-container .cart-name-button{border:none;background:transparent}.my-group-list-container .card-container .pagination{float:right;text-align:left;margin-top:10px}@media screen and (max-width:992px){.my-group-list-container .card-container .el-pagination__jump,.my-group-list-container .card-container .el-pagination__sizes,.my-group-list-container .card-container .el-pagination__total{display:none}}",""])},981:function(t,e,n){var r=n(876);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n(557)("19e2dd0f",r,!0)}});