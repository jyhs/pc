webpackJsonp([21],{1057:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-list-container"},[n("el-card",{staticClass:"card-container"},[n("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[n("el-row",{staticStyle:{width:"100%"}},[n("el-col",{attrs:{xs:24,sm:24,md:8,lg:8}},[n("div",{staticStyle:{"line-height":"36px"}},[n("el-icon",{staticClass:"el-icon-coral-list"}),e._v(" "),n("span",{staticClass:"card-title"},[e._v("团单列表")])],1)]),e._v(" "),n("el-col",{attrs:{xs:24,sm:24,md:16,lg:16}},[n("el-form",{ref:"searchForm",staticClass:"clear",attrs:{model:e.searchForm}},[n("el-form-item",{staticClass:"left",attrs:{label:"按团单名查找","label-width":"100px"}},[n("el-input",{model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),e._v(" "),n("el-form-item",{staticClass:"left",staticStyle:{"margin-left":"20px"}},[n("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.handleSearch}},[e._v("查询")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"coral-refresh"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1)],1),e._v(" "),n("el-row",[n("el-col",{attrs:{span:24}},[n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-striped"},[n("thead",[n("tr",[n("th",[e._v("团单名")]),e._v(" "),n("th",[e._v("组织者")]),e._v(" "),n("th",[e._v("组织者手机")]),e._v(" "),n("th",[e._v("开团城市")]),e._v(" "),n("th",[e._v("供货商")]),e._v(" "),n("th",[e._v("已团金额")]),e._v(" "),n("th",[e._v("当前状态")]),e._v(" "),n("th",[e._v("截止日期")]),e._v(" "),"tggly"===e.currentUser.type?n("th",{staticClass:"action-th"},[e._v("操作")]):e._e()])]),e._v(" "),n("tbody",e._l(e.groupList,function(t){return n("tr",{key:t.id},[n("td",[n("a",{attrs:{href:"javascript: void (0);"},on:{click:function(n){e.handleActions(t,"groupDetail")}}},[e._v("\n                                        "+e._s(t.name)+"\n                                    ")])]),e._v(" "),n("td",[e._v(e._s(t.contacts))]),e._v(" "),n("td",[e._v(e._s(t.phone))]),e._v(" "),n("td",[e._v(e._s(t.city))]),e._v(" "),n("td",[e._v(e._s(t.supplierName))]),e._v(" "),n("td",[n("span",{staticStyle:{color:"#d0021b"}},[e._v(e._s("￥"+t.sum.toFixed(2)))])]),e._v(" "),n("td",[1===t.status?n("el-tag",{attrs:{type:"success"}},[e._v("热团中")]):n("el-tag",[e._v("已结束")])],1),e._v(" "),n("td",[e._v(e._s(t.end_date))]),e._v(" "),"tggly"===e.currentUser.type?n("td",{attrs:{align:"center"}},[n("el-button",{attrs:{title:"编辑",size:"small",icon:"edit"},on:{click:function(n){e.handleActions(t,"groupEdit")}}}),e._v(" "),n("el-button",{attrs:{title:"导出",size:"small",icon:"coral-down"},on:{click:function(n){e.downloadAboutGroup(t)}}}),e._v(" "),1===t.status?n("el-button",{attrs:{title:"结束",size:"small",icon:"coral-close"},on:{click:function(n){e.handleActions(t,"finish")}}}):e._e(),e._v(" "),0===t.status?n("el-button",{attrs:{title:"重新开始",size:"small",icon:"coral-check"},on:{click:function(n){e.handleActions(t,"reopen")}}}):e._e(),e._v(" "),n("el-button",{attrs:{title:"删除",size:"small",icon:"coral-delete"},on:{click:function(n){e.handleActions(t,"delete")}}})],1):e._e()])}))])])])],1),e._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[10,20,30,40],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"提示",size:"tiny",visible:e.dialogVisible,"before-close":e.handleCancel},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("span",[e._v("你确定结束团单"+e._s(e.currentRow.name)+"？")]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),n("el-button",{on:{click:e.handleCancel}},[e._v("取消")])],1)]),e._v(" "),n("el-dialog",{attrs:{title:"重新开始",size:"tiny",visible:e.reopenVisible,"before-close":e.handleReopenCancel},on:{"update:visible":function(t){e.reopenVisible=t}}},[n("el-form",{attrs:{"label-width":"70px"}},[n("el-form-item",{attrs:{label:"截止时间"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择截止时间",editable:!1,"picker-options":e.pickerOptions},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmReopen}},[e._v("确定")]),e._v(" "),n("el-button",{on:{click:e.handleReopenCancel}},[e._v("取消")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"提示",size:"tiny",visible:e.deleteVisible,"before-close":e.handleDeleteCancel},on:{"update:visible":function(t){e.deleteVisible=t}}},[n("span",[e._v("你确定删除团单"+e._s(e.currentRow.name)+"？")]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmDelete}},[e._v("确定")]),e._v(" "),n("el-button",{on:{click:e.handleDeleteCancel}},[e._v("取消")])],1)])],1)},staticRenderFns:[]}},578:function(e,t,n){n(986);var r=n(223)(n(819),n(1057),null,null);e.exports=r.exports},600:function(e,t,n){e.exports={default:n(605),__esModule:!0}},601:function(e,t,n){"use strict";n.d(t,"f",function(){return l}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return h}),n.d(t,"d",function(){return v}),n.d(t,"k",function(){return b}),n.d(t,"h",function(){return m}),n.d(t,"g",function(){return _}),n.d(t,"i",function(){return y});var r=n(603),a=n.n(r),i=n(600),o=n.n(i),s=n(225),c=n.n(s),l=function(e){var t=new FormData,n=!0,r=!1,a=void 0;try{for(var i,s=c()(o()(e));!(n=(i=s.next()).done);n=!0){var l=i.value;t.append(l,e[l])}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return t},u=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,r="",a=0;a<e;a++)r+=t.charAt(Math.floor(Math.random()*n));return r},d=function(e){var t=new Date(e),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate();return""+t.getFullYear()+n+r+"235959"},p=function(e){return!e&&0!==e||("string"==typeof e&&!e.trim()||(!(!Array.prototype.isPrototypeOf(e)||0!==e.length)||!(!Object.prototype.isPrototypeOf(e)||0!==o()(e).length)))},f=function(e){return!p(window.localStorage.getItem(e))},g=function(e,t){p(t)||window.localStorage.setItem(e,a()(t))},h=function(e){return JSON.parse(window.localStorage.getItem(e))},v=function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=c()(t);!(n=(i=o.next()).done);n=!0){var s=i.value;if(s.code===e)return s.name}}catch(e){r=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return""},b=function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=c()(t);!(n=(i=o.next()).done);n=!0){var s=i.value;if(s.key===e)return s.value}}catch(e){r=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return""},m=function(e){var t=void 0;t="string"==typeof e?new Date(e):e;var n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate();return""+t.getFullYear()+n+r+"235959"},_=function(e){var t=void 0;t="string"==typeof e?new Date(e):e;var n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate(),a=t.getHours()<10?"0"+t.getHours():t.getHours(),i=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),o=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return""+t.getFullYear()+n+r+a+i+o},y=function(e){var t=document.getElementById(e),n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,1,12,345,7,220,!1,!1,!0,!1,0,null),t.dispatchEvent(n)};t.j={randomString:u,formatDate:d}},603:function(e,t,n){e.exports={default:n(604),__esModule:!0}},604:function(e,t,n){var r=n(20),a=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},605:function(e,t,n){n(607),e.exports=n(20).Object.keys},606:function(e,t,n){var r=n(37),a=n(20),i=n(67);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*i(function(){n(1)}),"Object",o)}},607:function(e,t,n){var r=n(148),a=n(74);n(606)("keys",function(){return function(e){return a(r(e))}})},819:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),a=n.n(r),i=n(57),o=n.n(i),s=n(99),c=n.n(s),l=n(224),u=n(59),d=n(601);t.default={data:function(){return{searchForm:{name:""},rules:{name:[{required:!0,message:"请填写查找的出货单名",trigger:"blur"}]},groupList:[],totalCount:0,page:1,size:10,provinces:[],dialogVisible:!1,reopenVisible:!1,deleteVisible:!1,currentRow:{},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},endDate:""}},computed:c()({},n.i(l.b)(["currentUser"])),created:function(){var e=this;return o()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading(!0),t.prev=1,!n.i(d.a)(u.g)){t.next=6;break}e.provinces=n.i(d.b)(u.g),t.next=10;break;case 6:return t.next=8,e.getProvinces();case 8:e.provinces=t.sent,n.i(d.c)(u.g,e.provinces);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.error(t.t0);case 15:e.loading(!1),e.initData();case 17:case"end":return t.stop()}},t,e,[[1,12]])}))()},methods:c()({},n.i(l.c)(["loading","getPayTypes","getYesOrNo","getProvinces","getGroupList","downloadGroupByIdAndUserId","finishGroupByIdAndUserId","reopenGroupByIdAndUserId","deleteGroupById"]),{initData:function(e){var t=this;return o()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading(!0),r=[],n.prev=2,n.next=5,t.getGroupList({name:e,page:t.page,size:t.size});case 5:r=n.sent,n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),console.error(n.t0);case 11:t.loading(!1),t.groupList=r.res||[],t.totalCount=r.count_res?r.count_res[0].count:0;case 14:case"end":return n.stop()}},n,t,[[2,8]])}))()},handleSearch:function(){var e=this;this.$refs.searchForm.validate(function(){var t=o()(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n&&e.initData(e.searchForm.name);case 1:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())},handleReset:function(){this.searchForm.name="",this.initData()},handleSizeChange:function(e){this.size=e,this.initData(this.searchForm.name)},handleCurrentChange:function(e){this.page=e,this.initData(this.searchForm.name)},handleActions:function(e,t){switch(t){case"groupEdit":case"groupDetail":this.$router.push({name:t,params:{id:e.id}});break;case"finish":this.currentRow=e,this.dialogVisible=!0;break;case"reopen":this.currentRow=e,this.reopenVisible=!0;break;case"delete":this.currentRow=e,this.deleteVisible=!0}},downloadAboutGroup:function(e){var t=this;return o()(a.a.mark(function n(){var r,i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading(!0),r={},n.prev=2,n.next=5,t.downloadGroupByIdAndUserId({id:e.id,user_id:e.user_id});case 5:r=n.sent,"ok"===r.status&&(i=document.createElement("iframe"),i.src=""+u.k+r.name+"?"+Math.random(),i.style.display="none",document.body.appendChild(i)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),console.error(n.t0);case 12:t.loading(!1);case 13:case"end":return n.stop()}},n,t,[[2,9]])}))()},handleCancel:function(){this.currentRow={},this.dialogVisible=!1},handleReopenCancel:function(){this.currentRow={},this.reopenVisible=!1},handleDeleteCancel:function(){this.currentRow={},this.deleteVisible=!1},handleConfirm:function(){var e=this;return o()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.dialogVisible=!1,e.loading(!0),n={},t.prev=3,t.next=6,e.finishGroupByIdAndUserId({id:e.currentRow.id,user_id:e.currentUser.id});case 6:n=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.error(t.t0);case 12:e.loading(!1),"ok"===n.status&&(e.$message({type:"success",message:"结束团单"+e.currentRow.name+"成功"}),e.initData());case 14:case"end":return t.stop()}},t,e,[[3,9]])}))()},handleConfirmReopen:function(){var e=this;return o()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.endDate){t.next=3;break}return e.$notify({type:"warning",message:"请选择截止时间"}),t.abrupt("return");case 3:return e.reopenVisible=!1,e.loading(!0),r={},t.prev=6,t.next=9,e.reopenGroupByIdAndUserId({id:e.currentRow.id,user_id:e.currentUser.id,end_date:n.i(d.g)(e.endDate)});case 9:r=t.sent,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),console.error(t.t0);case 15:e.loading(!1),"ok"===r.status&&(e.$message({type:"success",message:"重新开始团单"+e.currentRow.name+"成功",duration:5e3}),e.endDate="",e.initData());case 17:case"end":return t.stop()}},t,e,[[6,12]])}))()},handleConfirmDelete:function(){var e=this;return o()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.deleteVisible=!1,e.loading(!0),n={},t.prev=3,t.next=6,e.deleteGroupById({id:e.currentRow.id,user_id:e.currentUser.id});case 6:n=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.error(t.t0);case 12:e.loading(!1),"ok"===n.status&&(e.$message({type:"success",message:"删除团单"+e.currentRow.name+"成功",duration:5e3}),e.endDate="",e.initData());case 14:case"end":return t.stop()}},t,e,[[3,9]])}))()}}),watch:{$route:function(e){"groupList"===e.name&&this.initData()}}}},881:function(e,t,n){t=e.exports=n(556)(!1),t.push([e.i,".group-list-container{padding:10px}.group-list-container .card-container a{text-decoration:none;cursor:pointer}.group-list-container .card-container a:hover{cursor:pointer}.group-list-container .card-container .el-card__header{padding:10px 20px}.group-list-container .card-container .el-card__body{padding:10px}.group-list-container .card-container .el-button{background:transparent;border:none}.group-list-container .card-container .el-button i,.group-list-container .card-container .el-button span{color:#20a0ff}.group-list-container .card-container .el-button:focus,.group-list-container .card-container .el-button:hover{background:#20a0ff}.group-list-container .card-container .el-button:focus i,.group-list-container .card-container .el-button:focus span,.group-list-container .card-container .el-button:hover i,.group-list-container .card-container .el-button:hover span{color:#fff}.group-list-container .card-container .el-button.is-disabled{background:transparent}.group-list-container .card-container .el-button.is-disabled i,.group-list-container .card-container .el-button.is-disabled span{color:#bfcbd9}.group-list-container .card-container .el-button.is-disabled:focus,.group-list-container .card-container .el-button.is-disabled:hover{background:transparent}.group-list-container .card-container .el-button.is-disabled:focus i,.group-list-container .card-container .el-button.is-disabled:focus span,.group-list-container .card-container .el-button.is-disabled:hover i,.group-list-container .card-container .el-button.is-disabled:hover span{color:#bfcbd9}.group-list-container .card-container .table td{vertical-align:middle;padding:4px}.group-list-container .card-container .table .action-th{text-align:center}.group-list-container .card-container .card-header{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.group-list-container .card-container .card-header i{font-size:16px}.group-list-container .card-container .card-header .card-title{line-height:36px;font-size:16px;font-weight:700}.group-list-container .card-container .card-header .el-form-item{margin-bottom:0}.group-list-container .card-container .pagination{float:right;text-align:left;margin-top:10px}@media screen and (max-width:992px){.group-list-container .card-container .el-pagination__jump,.group-list-container .card-container .el-pagination__sizes,.group-list-container .card-container .el-pagination__total{display:none}}",""])},986:function(e,t,n){var r=n(881);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n(557)("2621fc48",r,!0)}});